<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>8.2 Solution | Computational Statistics</title>
  <meta name="description" content="8.2 Solution | Computational Statistics with R Course Notes" />
  <meta name="generator" content="bookdown 0.29 and GitBook 2.6.7" />

  <meta property="og:title" content="8.2 Solution | Computational Statistics" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="8.2 Solution | Computational Statistics with R Course Notes" />
  <meta name="github-repo" content="bchwtz/bchwtz-cswr" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="8.2 Solution | Computational Statistics" />
  
  <meta name="twitter:description" content="8.2 Solution | Computational Statistics with R Course Notes" />
  

<meta name="author" content="Benjamin Buchwitz" />


<meta name="date" content="2022-10-20" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="requirements.html"/>
<link rel="next" href="blockchain.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./"><b>Computational Statistics</b></a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Hello World!</a><ul>
<li class="chapter" data-level="" data-path="installation.html"><a href="installation.html"><i class="fa fa-check"></i>Installation</a><ul>
<li class="chapter" data-level="" data-path="installation.html"><a href="installation.html#r-language-base-system"><i class="fa fa-check"></i>R Language (Base System)</a></li>
<li class="chapter" data-level="" data-path="installation.html"><a href="installation.html#r-studio-ide"><i class="fa fa-check"></i>R-Studio (IDE)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="1" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>1</b> The Basics</a><ul>
<li class="chapter" data-level="1.1" data-path="r-and-the-r-project.html"><a href="r-and-the-r-project.html"><i class="fa fa-check"></i><b>1.1</b> R and the R-Project</a></li>
<li class="chapter" data-level="1.2" data-path="r-system-and-rstudio.html"><a href="r-system-and-rstudio.html"><i class="fa fa-check"></i><b>1.2</b> R System and RStudio</a></li>
<li class="chapter" data-level="1.3" data-path="first-steps-r-as-calculator.html"><a href="first-steps-r-as-calculator.html"><i class="fa fa-check"></i><b>1.3</b> First Steps: R as Calculator</a></li>
<li class="chapter" data-level="1.4" data-path="objects-and-data-structures.html"><a href="objects-and-data-structures.html"><i class="fa fa-check"></i><b>1.4</b> Objects and Data Structures</a><ul>
<li class="chapter" data-level="1.4.1" data-path="objects-and-data-structures.html"><a href="objects-and-data-structures.html#data-structure-vectors"><i class="fa fa-check"></i><b>1.4.1</b> Data Structure: Vectors</a></li>
<li class="chapter" data-level="1.4.2" data-path="objects-and-data-structures.html"><a href="objects-and-data-structures.html#data-structure-matrices"><i class="fa fa-check"></i><b>1.4.2</b> Data Structure: Matrices</a></li>
<li class="chapter" data-level="1.4.3" data-path="objects-and-data-structures.html"><a href="objects-and-data-structures.html#data-structure-strings"><i class="fa fa-check"></i><b>1.4.3</b> Data Structure: Strings</a></li>
<li class="chapter" data-level="1.4.4" data-path="objects-and-data-structures.html"><a href="objects-and-data-structures.html#data-structure-lists-and-data-frames"><i class="fa fa-check"></i><b>1.4.4</b> Data Structure: Lists and Data Frames</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="functions.html"><a href="functions.html"><i class="fa fa-check"></i><b>1.5</b> Functions</a><ul>
<li class="chapter" data-level="1.5.1" data-path="functions.html"><a href="functions.html#using-functions"><i class="fa fa-check"></i><b>1.5.1</b> Using Functions</a></li>
<li class="chapter" data-level="1.5.2" data-path="functions.html"><a href="functions.html#writing-functions"><i class="fa fa-check"></i><b>1.5.2</b> Writing Functions</a></li>
<li class="chapter" data-level="1.5.3" data-path="functions.html"><a href="functions.html#solving-problems"><i class="fa fa-check"></i><b>1.5.3</b> Solving Problems</a></li>
</ul></li>
<li class="chapter" data-level="1.6" data-path="packages.html"><a href="packages.html"><i class="fa fa-check"></i><b>1.6</b> Packages</a><ul>
<li class="chapter" data-level="1.6.1" data-path="packages.html"><a href="packages.html#packages-with-data"><i class="fa fa-check"></i><b>1.6.1</b> Packages with Data</a></li>
<li class="chapter" data-level="1.6.2" data-path="packages.html"><a href="packages.html#packages-with-functions"><i class="fa fa-check"></i><b>1.6.2</b> Packages with Functions</a></li>
</ul></li>
<li class="chapter" data-level="1.7" data-path="getting-help.html"><a href="getting-help.html"><i class="fa fa-check"></i><b>1.7</b> Getting Help</a><ul>
<li class="chapter" data-level="1.7.1" data-path="getting-help.html"><a href="getting-help.html#integrated-help-system"><i class="fa fa-check"></i><b>1.7.1</b> Integrated Help System</a></li>
<li class="chapter" data-level="1.7.2" data-path="getting-help.html"><a href="getting-help.html#help-on-the-internet"><i class="fa fa-check"></i><b>1.7.2</b> Help on the Internet</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="exercises.html"><a href="exercises.html"><i class="fa fa-check"></i>Exercises</a><ul>
<li class="chapter" data-level="" data-path="exercises.html"><a href="exercises.html#ex-1"><i class="fa fa-check"></i>EX 1</a></li>
<li class="chapter" data-level="" data-path="exercises.html"><a href="exercises.html#ex-2"><i class="fa fa-check"></i>EX 2</a></li>
<li class="chapter" data-level="" data-path="exercises.html"><a href="exercises.html#ex-3"><i class="fa fa-check"></i>EX 3</a></li>
<li class="chapter" data-level="" data-path="exercises.html"><a href="exercises.html#ex-4"><i class="fa fa-check"></i>EX 4</a></li>
<li class="chapter" data-level="" data-path="exercises.html"><a href="exercises.html#ex-5"><i class="fa fa-check"></i>EX 5</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="data-types.html"><a href="data-types.html"><i class="fa fa-check"></i><b>2</b> Data Types</a><ul>
<li class="chapter" data-level="2.1" data-path="fixed-and-floating-point-number-representation.html"><a href="fixed-and-floating-point-number-representation.html"><i class="fa fa-check"></i><b>2.1</b> Fixed and Floating Point Number Representation</a></li>
<li class="chapter" data-level="2.2" data-path="numeric.html"><a href="numeric.html"><i class="fa fa-check"></i><b>2.2</b> Numeric</a></li>
<li class="chapter" data-level="2.3" data-path="complex.html"><a href="complex.html"><i class="fa fa-check"></i><b>2.3</b> Complex</a></li>
<li class="chapter" data-level="2.4" data-path="logical.html"><a href="logical.html"><i class="fa fa-check"></i><b>2.4</b> Logical</a></li>
<li class="chapter" data-level="2.5" data-path="character.html"><a href="character.html"><i class="fa fa-check"></i><b>2.5</b> Character</a></li>
<li class="chapter" data-level="2.6" data-path="factors.html"><a href="factors.html"><i class="fa fa-check"></i><b>2.6</b> Factors</a><ul>
<li class="chapter" data-level="2.6.1" data-path="factors.html"><a href="factors.html#unordered-factors"><i class="fa fa-check"></i><b>2.6.1</b> Unordered Factors</a></li>
<li class="chapter" data-level="2.6.2" data-path="factors.html"><a href="factors.html#ordered-factors"><i class="fa fa-check"></i><b>2.6.2</b> Ordered Factors</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="missing-and-raw-data.html"><a href="missing-and-raw-data.html"><i class="fa fa-check"></i><b>2.7</b> Missing and Raw Data</a></li>
<li class="chapter" data-level="2.8" data-path="coercion-attributes-and-class.html"><a href="coercion-attributes-and-class.html"><i class="fa fa-check"></i><b>2.8</b> Coercion, Attributes, and Class</a><ul>
<li class="chapter" data-level="2.8.1" data-path="coercion-attributes-and-class.html"><a href="coercion-attributes-and-class.html#coercion"><i class="fa fa-check"></i><b>2.8.1</b> Coercion</a></li>
<li class="chapter" data-level="2.8.2" data-path="coercion-attributes-and-class.html"><a href="coercion-attributes-and-class.html#attributes-and-names"><i class="fa fa-check"></i><b>2.8.2</b> Attributes and Names</a></li>
<li class="chapter" data-level="2.8.3" data-path="coercion-attributes-and-class.html"><a href="coercion-attributes-and-class.html#class"><i class="fa fa-check"></i><b>2.8.3</b> Class</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="exercises-1.html"><a href="exercises-1.html"><i class="fa fa-check"></i>Exercises</a><ul>
<li class="chapter" data-level="" data-path="exercises-1.html"><a href="exercises-1.html#from-april-5-2022"><i class="fa fa-check"></i>From April 5, 2022</a></li>
<li class="chapter" data-level="" data-path="exercises-1.html"><a href="exercises-1.html#ex-1-1"><i class="fa fa-check"></i>EX 1</a></li>
<li class="chapter" data-level="" data-path="exercises-1.html"><a href="exercises-1.html#ex-2-1"><i class="fa fa-check"></i>EX 2</a></li>
<li class="chapter" data-level="" data-path="exercises-1.html"><a href="exercises-1.html#ex-3-1"><i class="fa fa-check"></i>EX 3</a></li>
<li class="chapter" data-level="" data-path="exercises-1.html"><a href="exercises-1.html#ex-4-1"><i class="fa fa-check"></i>EX 4</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="data-manipulation.html"><a href="data-manipulation.html"><i class="fa fa-check"></i><b>3</b> Data Manipulation</a><ul>
<li class="chapter" data-level="3.1" data-path="vectors.html"><a href="vectors.html"><i class="fa fa-check"></i><b>3.1</b> Vectors</a></li>
<li class="chapter" data-level="3.2" data-path="matrices-and-arrays.html"><a href="matrices-and-arrays.html"><i class="fa fa-check"></i><b>3.2</b> Matrices and Arrays</a></li>
<li class="chapter" data-level="3.3" data-path="lists.html"><a href="lists.html"><i class="fa fa-check"></i><b>3.3</b> Lists</a></li>
<li class="chapter" data-level="3.4" data-path="dataframes.html"><a href="dataframes.html"><i class="fa fa-check"></i><b>3.4</b> Dataframes</a><ul>
<li class="chapter" data-level="" data-path="dataframes.html"><a href="dataframes.html#merging-rows-and-columns"><i class="fa fa-check"></i>Merging rows and columns</a></li>
<li class="chapter" data-level="" data-path="dataframes.html"><a href="dataframes.html#apply-functions-to-rows-and-columns"><i class="fa fa-check"></i>Apply functions to rows and columns</a></li>
<li class="chapter" data-level="" data-path="dataframes.html"><a href="dataframes.html#sweep-out-statistics-in-a-matrix"><i class="fa fa-check"></i>Sweep out Statistics in a Matrix</a></li>
<li class="chapter" data-level="" data-path="dataframes.html"><a href="dataframes.html#concatenate-all-values-from-a-dataframe"><i class="fa fa-check"></i>Concatenate all values from a dataframe</a></li>
<li class="chapter" data-level="" data-path="dataframes.html"><a href="dataframes.html#splitting-dataframes-while-applying-functions"><i class="fa fa-check"></i>Splitting dataframes while applying functions</a></li>
<li class="chapter" data-level="" data-path="dataframes.html"><a href="dataframes.html#transformations-without-recreating-dataframes"><i class="fa fa-check"></i>Transformations without recreating dataframes</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="strings.html"><a href="strings.html"><i class="fa fa-check"></i><b>3.5</b> Strings</a></li>
<li class="chapter" data-level="3.6" data-path="dates-and-times.html"><a href="dates-and-times.html"><i class="fa fa-check"></i><b>3.6</b> Dates and Times</a></li>
<li class="chapter" data-level="" data-path="exercises-2.html"><a href="exercises-2.html"><i class="fa fa-check"></i>Exercises</a><ul>
<li class="chapter" data-level="" data-path="exercises-2.html"><a href="exercises-2.html#from-april-12-2022"><i class="fa fa-check"></i>From April 12, 2022</a></li>
<li class="chapter" data-level="" data-path="exercises-2.html"><a href="exercises-2.html#ex-1-2"><i class="fa fa-check"></i>EX 1</a></li>
<li class="chapter" data-level="" data-path="exercises-2.html"><a href="exercises-2.html#ex-2-2"><i class="fa fa-check"></i>EX 2</a></li>
<li class="chapter" data-level="" data-path="exercises-2.html"><a href="exercises-2.html#ex-3-2"><i class="fa fa-check"></i>EX 3</a></li>
<li class="chapter" data-level="" data-path="exercises-2.html"><a href="exercises-2.html#ex-4-2"><i class="fa fa-check"></i>EX 4</a></li>
<li class="chapter" data-level="" data-path="exercises-2.html"><a href="exercises-2.html#ex-5-1"><i class="fa fa-check"></i>EX 5</a></li>
<li class="chapter" data-level="" data-path="exercises-2.html"><a href="exercises-2.html#ex-6"><i class="fa fa-check"></i>EX 6</a></li>
<li class="chapter" data-level="" data-path="exercises-2.html"><a href="exercises-2.html#ex-7"><i class="fa fa-check"></i>EX 7</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="structure.html"><a href="structure.html"><i class="fa fa-check"></i><b>4</b> Code Structure</a><ul>
<li class="chapter" data-level="4.1" data-path="conditional-expressions.html"><a href="conditional-expressions.html"><i class="fa fa-check"></i><b>4.1</b> Conditional Expressions</a><ul>
<li class="chapter" data-level="" data-path="conditional-expressions.html"><a href="conditional-expressions.html#if-and-else"><i class="fa fa-check"></i>If and Else</a></li>
<li class="chapter" data-level="" data-path="conditional-expressions.html"><a href="conditional-expressions.html#switch"><i class="fa fa-check"></i>Switch</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="loops.html"><a href="loops.html"><i class="fa fa-check"></i><b>4.2</b> Loops</a><ul>
<li class="chapter" data-level="" data-path="loops.html"><a href="loops.html#for-loop"><i class="fa fa-check"></i>For-Loop</a></li>
<li class="chapter" data-level="" data-path="loops.html"><a href="loops.html#while-loop"><i class="fa fa-check"></i>While-Loop</a></li>
<li class="chapter" data-level="" data-path="loops.html"><a href="loops.html#repeat"><i class="fa fa-check"></i>Repeat</a></li>
<li class="chapter" data-level="" data-path="loops.html"><a href="loops.html#break-and-next"><i class="fa fa-check"></i>Break and Next</a></li>
<li class="chapter" data-level="" data-path="loops.html"><a href="loops.html#special-looping-over-non-numerical-data"><i class="fa fa-check"></i>Special: Looping over non-numerical data</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="exercises-3.html"><a href="exercises-3.html"><i class="fa fa-check"></i>Exercises</a><ul>
<li class="chapter" data-level="" data-path="exercises-3.html"><a href="exercises-3.html#from-april-26-2022"><i class="fa fa-check"></i>From April 26, 2022</a></li>
<li class="chapter" data-level="" data-path="exercises-3.html"><a href="exercises-3.html#bottles-of-beer"><i class="fa fa-check"></i>99 Bottles of Beer</a></li>
<li class="chapter" data-level="4.2.1" data-path="exercises-3.html"><a href="exercises-3.html#multiplication-table"><i class="fa fa-check"></i><b>4.2.1</b> Multiplication Table</a></li>
<li class="chapter" data-level="4.2.2" data-path="exercises-3.html"><a href="exercises-3.html#diagonal-matrix"><i class="fa fa-check"></i><b>4.2.2</b> Diagonal Matrix</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="software-development.html"><a href="software-development.html"><i class="fa fa-check"></i><b>5</b> Software Development</a><ul>
<li class="chapter" data-level="5.1" data-path="planning.html"><a href="planning.html"><i class="fa fa-check"></i><b>5.1</b> Planning</a></li>
<li class="chapter" data-level="5.2" data-path="coding.html"><a href="coding.html"><i class="fa fa-check"></i><b>5.2</b> Coding</a><ul>
<li class="chapter" data-level="5.2.1" data-path="coding.html"><a href="coding.html#standard-program-structure"><i class="fa fa-check"></i><b>5.2.1</b> Standard Program Structure</a></li>
<li class="chapter" data-level="5.2.2" data-path="coding.html"><a href="coding.html#standard-function-structure"><i class="fa fa-check"></i><b>5.2.2</b> Standard Function Structure</a></li>
<li class="chapter" data-level="5.2.3" data-path="coding.html"><a href="coding.html#naming-convention"><i class="fa fa-check"></i><b>5.2.3</b> Naming Convention</a></li>
<li class="chapter" data-level="5.2.4" data-path="coding.html"><a href="coding.html#rules-best-practices"><i class="fa fa-check"></i><b>5.2.4</b> Rules &amp; Best Practices</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="documenting.html"><a href="documenting.html"><i class="fa fa-check"></i><b>5.3</b> Documenting</a><ul>
<li class="chapter" data-level="5.3.1" data-path="documenting.html"><a href="documenting.html#code-documentation-short-form-documentation"><i class="fa fa-check"></i><b>5.3.1</b> Code Documentation (Short-form Documentation)</a></li>
<li class="chapter" data-level="5.3.2" data-path="documenting.html"><a href="documenting.html#user-documentation-long-form-documentation"><i class="fa fa-check"></i><b>5.3.2</b> User documentation (Long-form Documentation)</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="testing.html"><a href="testing.html"><i class="fa fa-check"></i><b>5.4</b> Testing</a></li>
<li class="chapter" data-level="5.5" data-path="maintaining.html"><a href="maintaining.html"><i class="fa fa-check"></i><b>5.5</b> Maintaining</a></li>
<li class="chapter" data-level="" data-path="exercises-4.html"><a href="exercises-4.html"><i class="fa fa-check"></i>Exercises</a><ul>
<li class="chapter" data-level="" data-path="exercises-4.html"><a href="exercises-4.html#from-may-3-2022"><i class="fa fa-check"></i>From May 3, 2022</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="vectorization.html"><a href="vectorization.html"><i class="fa fa-check"></i><b>6</b> Vectorization</a><ul>
<li class="chapter" data-level="6.1" data-path="apply-family.html"><a href="apply-family.html"><i class="fa fa-check"></i><b>6.1</b> *apply-Family</a><ul>
<li class="chapter" data-level="" data-path="apply-family.html"><a href="apply-family.html#apply"><i class="fa fa-check"></i>apply</a></li>
<li class="chapter" data-level="" data-path="apply-family.html"><a href="apply-family.html#lapply"><i class="fa fa-check"></i>lapply</a></li>
<li class="chapter" data-level="" data-path="apply-family.html"><a href="apply-family.html#sapply"><i class="fa fa-check"></i>sapply</a></li>
<li class="chapter" data-level="" data-path="apply-family.html"><a href="apply-family.html#vapply"><i class="fa fa-check"></i>vapply</a></li>
<li class="chapter" data-level="" data-path="apply-family.html"><a href="apply-family.html#tapply"><i class="fa fa-check"></i>tapply</a></li>
<li class="chapter" data-level="" data-path="apply-family.html"><a href="apply-family.html#mapply"><i class="fa fa-check"></i>mapply</a></li>
<li class="chapter" data-level="" data-path="apply-family.html"><a href="apply-family.html#rapply"><i class="fa fa-check"></i>rapply</a></li>
<li class="chapter" data-level="" data-path="apply-family.html"><a href="apply-family.html#eapply"><i class="fa fa-check"></i>eapply</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="technical-background.html"><a href="technical-background.html"><i class="fa fa-check"></i><b>6.2</b> Technical Background</a></li>
<li class="chapter" data-level="6.3" data-path="parallelization-using-vectorized-functions.html"><a href="parallelization-using-vectorized-functions.html"><i class="fa fa-check"></i><b>6.3</b> Parallelization using vectorized functions</a></li>
<li class="chapter" data-level="" data-path="exercises-5.html"><a href="exercises-5.html"><i class="fa fa-check"></i>Exercises</a><ul>
<li class="chapter" data-level="" data-path="exercises-5.html"><a href="exercises-5.html#from-may-10-2022"><i class="fa fa-check"></i>From May 10, 2022</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="applications---graphics.html"><a href="applications---graphics.html"><i class="fa fa-check"></i><b>7</b> Applications - Graphics</a><ul>
<li class="chapter" data-level="7.1" data-path="plotsbaseR.html"><a href="plotsbaseR.html"><i class="fa fa-check"></i><b>7.1</b> Plots with base R</a><ul>
<li class="chapter" data-level="7.1.1" data-path="plotsbaseR.html"><a href="plotsbaseR.html#plot"><i class="fa fa-check"></i><b>7.1.1</b> <code>plot()</code></a></li>
<li class="chapter" data-level="7.1.2" data-path="plotsbaseR.html"><a href="plotsbaseR.html#histograms-and-boxplots"><i class="fa fa-check"></i><b>7.1.2</b> Histograms and boxplots</a></li>
<li class="chapter" data-level="7.1.3" data-path="plotsbaseR.html"><a href="plotsbaseR.html#scatterplots-and-linear-regression"><i class="fa fa-check"></i><b>7.1.3</b> Scatterplots and linear regression</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="plotsggplot2.html"><a href="plotsggplot2.html"><i class="fa fa-check"></i><b>7.2</b> Plots with <code>ggplot2</code> <span class="citation">(Wickham <span>2016</span>)</span></a><ul>
<li class="chapter" data-level="7.2.1" data-path="plotsggplot2.html"><a href="plotsggplot2.html#histograms-and-boxplots-1"><i class="fa fa-check"></i><b>7.2.1</b> Histograms and boxplots</a></li>
<li class="chapter" data-level="7.2.2" data-path="plotsggplot2.html"><a href="plotsggplot2.html#linear-regression"><i class="fa fa-check"></i><b>7.2.2</b> Linear regression</a></li>
<li class="chapter" data-level="7.2.3" data-path="plotsggplot2.html"><a href="plotsggplot2.html#customizing-ggplots"><i class="fa fa-check"></i><b>7.2.3</b> Customizing ggplots</a></li>
<li class="chapter" data-level="7.2.4" data-path="plotsggplot2.html"><a href="plotsggplot2.html#handling-2-variables-and-faceting"><i class="fa fa-check"></i><b>7.2.4</b> Handling &gt; 2 variables and faceting</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="interactive-plots-with-plotly-plotly.html"><a href="interactive-plots-with-plotly-plotly.html"><i class="fa fa-check"></i><b>7.3</b> Interactive plots with <code>plotly</code> <span class="citation">(Sievert <span>2020</span>)</span></a></li>
<li class="chapter" data-level="" data-path="excercises.html"><a href="excercises.html"><i class="fa fa-check"></i>Excercises</a><ul>
<li class="chapter" data-level="" data-path="excercises.html"><a href="excercises.html#task-mtcars-dataset"><i class="fa fa-check"></i>Task <code>mtcars</code> dataset</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="word-puzzle.html"><a href="word-puzzle.html"><i class="fa fa-check"></i><b>8</b> Word Puzzle</a><ul>
<li class="chapter" data-level="8.1" data-path="requirements.html"><a href="requirements.html"><i class="fa fa-check"></i><b>8.1</b> Requirements</a></li>
<li class="chapter" data-level="8.2" data-path="solution.html"><a href="solution.html"><i class="fa fa-check"></i><b>8.2</b> Solution</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="blockchain.html"><a href="blockchain.html"><i class="fa fa-check"></i><b>9</b> Blockchain</a><ul>
<li class="chapter" data-level="9.1" data-path="hash-functions.html"><a href="hash-functions.html"><i class="fa fa-check"></i><b>9.1</b> Hash Functions</a><ul>
<li class="chapter" data-level="" data-path="hash-functions.html"><a href="hash-functions.html#exercises-6"><i class="fa fa-check"></i>Exercises</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="blocks.html"><a href="blocks.html"><i class="fa fa-check"></i><b>9.2</b> Blocks</a></li>
<li class="chapter" data-level="9.3" data-path="proof-of-work-pow.html"><a href="proof-of-work-pow.html"><i class="fa fa-check"></i><b>9.3</b> Proof of Work (PoW)</a><ul>
<li class="chapter" data-level="" data-path="proof-of-work-pow.html"><a href="proof-of-work-pow.html#simple-pow-example"><i class="fa fa-check"></i>Simple PoW Example</a></li>
<li class="chapter" data-level="" data-path="proof-of-work-pow.html"><a href="proof-of-work-pow.html#combining-pow-and-hashing"><i class="fa fa-check"></i>Combining PoW and Hashing</a></li>
<li class="chapter" data-level="" data-path="proof-of-work-pow.html"><a href="proof-of-work-pow.html#exercises-7"><i class="fa fa-check"></i>Exercises</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="chaining-blocks.html"><a href="chaining-blocks.html"><i class="fa fa-check"></i><b>9.4</b> Chaining Blocks</a></li>
<li class="chapter" data-level="9.5" data-path="security.html"><a href="security.html"><i class="fa fa-check"></i><b>9.5</b> Security</a><ul>
<li class="chapter" data-level="" data-path="security.html"><a href="security.html#manipulation-1"><i class="fa fa-check"></i>Manipulation 1</a></li>
<li class="chapter" data-level="" data-path="security.html"><a href="security.html#manipulation-2"><i class="fa fa-check"></i>Manipulation 2</a></li>
</ul></li>
<li class="chapter" data-level="9.6" data-path="wrap-up.html"><a href="wrap-up.html"><i class="fa fa-check"></i><b>9.6</b> Wrap up</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="forecasting.html"><a href="forecasting.html"><i class="fa fa-check"></i><b>10</b> Forecasting</a><ul>
<li class="chapter" data-level="10.1" data-path="time-series-data.html"><a href="time-series-data.html"><i class="fa fa-check"></i><b>10.1</b> Time Series Data</a></li>
<li class="chapter" data-level="10.2" data-path="forecasting-process.html"><a href="forecasting-process.html"><i class="fa fa-check"></i><b>10.2</b> Forecasting Process</a></li>
<li class="chapter" data-level="10.3" data-path="real-data.html"><a href="real-data.html"><i class="fa fa-check"></i><b>10.3</b> Real Data</a></li>
<li class="chapter" data-level="10.4" data-path="judgemental-forecasting.html"><a href="judgemental-forecasting.html"><i class="fa fa-check"></i><b>10.4</b> Judgemental Forecasting</a></li>
<li class="chapter" data-level="10.5" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html"><i class="fa fa-check"></i><b>10.5</b> Exponential Smoothing</a><ul>
<li class="chapter" data-level="10.5.1" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#implementing-hes"><i class="fa fa-check"></i><b>10.5.1</b> Implementing HES</a></li>
<li class="chapter" data-level="10.5.2" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#finding-best-alpha-and-gamma-values"><i class="fa fa-check"></i><b>10.5.2</b> Finding best alpha and gamma values</a></li>
<li class="chapter" data-level="10.5.3" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#generating-forecasts"><i class="fa fa-check"></i><b>10.5.3</b> Generating Forecasts</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="exercises-8.html"><a href="exercises-8.html"><i class="fa fa-check"></i>Exercises</a></li>
<li class="chapter" data-level="10.6" data-path="practical-application.html"><a href="practical-application.html"><i class="fa fa-check"></i><b>10.6</b> Practical Application</a></li>
<li class="chapter" data-level="10.7" data-path="forecast-evaluation.html"><a href="forecast-evaluation.html"><i class="fa fa-check"></i><b>10.7</b> Forecast Evaluation</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="web-apps.html"><a href="web-apps.html"><i class="fa fa-check"></i><b>11</b> Web Apps</a><ul>
<li class="chapter" data-level="" data-path="exercises-9.html"><a href="exercises-9.html"><i class="fa fa-check"></i>Exercises</a><ul>
<li class="chapter" data-level="" data-path="exercises-9.html"><a href="exercises-9.html#from-june-21-2022"><i class="fa fa-check"></i>From June 21, 2022</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>Accompanying Work</b></span></li>
<li class="chapter" data-level="" data-path="homework-assignment.html"><a href="homework-assignment.html"><i class="fa fa-check"></i>Homework Assignment</a></li>
<li class="chapter" data-level="" data-path="literature.html"><a href="literature.html"><i class="fa fa-check"></i>Literature</a></li>
<li class="chapter" data-level="" data-path="programming-project.html"><a href="programming-project.html"><i class="fa fa-check"></i>Programming Project</a><ul>
<li class="chapter" data-level="" data-path="topic-1-web-scraping.html"><a href="topic-1-web-scraping.html"><i class="fa fa-check"></i>Topic 1: Web Scraping</a></li>
<li class="chapter" data-level="" data-path="topic-2-forecasting.html"><a href="topic-2-forecasting.html"><i class="fa fa-check"></i>Topic 2: Forecasting</a></li>
<li class="chapter" data-level="" data-path="topic-3-algorithm-implementation-data-analysis.html"><a href="topic-3-algorithm-implementation-data-analysis.html"><i class="fa fa-check"></i>Topic 3: Algorithm Implementation &amp; Data Analysis</a></li>
<li class="chapter" data-level="" data-path="topic-4-custom-topic.html"><a href="topic-4-custom-topic.html"><i class="fa fa-check"></i>Topic 4: Custom Topic</a></li>
</ul></li>
<li class="appendix"><span><b>Appendix</b></span></li>
<li class="chapter" data-level="A" data-path="bug-bounty.html"><a href="bug-bounty.html"><i class="fa fa-check"></i><b>A</b> Bug Bounty</a><ul>
<li class="chapter" data-level="" data-path="leaderboard.html"><a href="leaderboard.html"><i class="fa fa-check"></i>Leaderboard</a></li>
<li class="chapter" data-level="" data-path="what-is-this.html"><a href="what-is-this.html"><i class="fa fa-check"></i>What is this?</a></li>
</ul></li>
<li class="chapter" data-level="B" data-path="test-exam.html"><a href="test-exam.html"><i class="fa fa-check"></i><b>B</b> Test Exam</a><ul>
<li class="chapter" data-level="B.1" data-path="additional-exercises.html"><a href="additional-exercises.html"><i class="fa fa-check"></i><b>B.1</b> Additional Exercises</a><ul>
<li class="chapter" data-level="B.1.1" data-path="additional-exercises.html"><a href="additional-exercises.html#exercise-i"><i class="fa fa-check"></i><b>B.1.1</b> Exercise I</a></li>
</ul></li>
<li class="chapter" data-level="B.2" data-path="exercise-ii.html"><a href="exercise-ii.html"><i class="fa fa-check"></i><b>B.2</b> Exercise II</a><ul>
<li class="chapter" data-level="B.2.1" data-path="exercise-ii.html"><a href="exercise-ii.html#exercise-iii"><i class="fa fa-check"></i><b>B.2.1</b> Exercise III</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="http://www.bchwtz.de" target="blank"><center>www.<b>BCHWTZ</b>.de</center></a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Computational Statistics</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="solution" class="section level2 hasAnchor">
<h2><span class="header-section-number">8.2</span> Solution<a href="solution.html#solution" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Let us start to solve the Excercise by generating a matrix full of letters from the desired word. We can easily do this using the <code>sample()</code>-command. If we want to fill the matrix one by one we can do this easily with two nested <code>for</code>-loops we just discussed, but the <code>matrix()</code>-command is much faster and the better option here.</p>
<div class="sourceCode" id="cb643"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb643-1"><a href="solution.html#cb643-1"></a>word &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;K&quot;</span>,<span class="st">&quot;A&quot;</span>,<span class="st">&quot;Y&quot;</span>,<span class="st">&quot;A&quot;</span>,<span class="st">&quot;K&quot;</span>)</span>
<span id="cb643-2"><a href="solution.html#cb643-2"></a></span>
<span id="cb643-3"><a href="solution.html#cb643-3"></a>cols &lt;-<span class="st"> </span><span class="dv">15</span></span>
<span id="cb643-4"><a href="solution.html#cb643-4"></a>rows &lt;-<span class="st"> </span><span class="dv">10</span></span>
<span id="cb643-5"><a href="solution.html#cb643-5"></a></span>
<span id="cb643-6"><a href="solution.html#cb643-6"></a><span class="co"># Generate word matrix with loops (very inefficient and slow!)</span></span>
<span id="cb643-7"><a href="solution.html#cb643-7"></a>mat &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="ot">NA</span>,<span class="dt">nrow=</span>rows,<span class="dt">ncol=</span>cols)</span>
<span id="cb643-8"><a href="solution.html#cb643-8"></a><span class="cf">for</span> ( idx <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>rows) {</span>
<span id="cb643-9"><a href="solution.html#cb643-9"></a>  <span class="cf">for</span> (jdx <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>cols) {</span>
<span id="cb643-10"><a href="solution.html#cb643-10"></a>    mat[idx,jdx] &lt;-<span class="st"> </span><span class="kw">sample</span>(word,<span class="dt">size=</span><span class="dv">1</span>) </span>
<span id="cb643-11"><a href="solution.html#cb643-11"></a>  }</span>
<span id="cb643-12"><a href="solution.html#cb643-12"></a>}</span>
<span id="cb643-13"><a href="solution.html#cb643-13"></a></span>
<span id="cb643-14"><a href="solution.html#cb643-14"></a><span class="co"># Generate word matrix vectorized (the way to go!)</span></span>
<span id="cb643-15"><a href="solution.html#cb643-15"></a>mat &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">sample</span>(word,<span class="dt">replace=</span>T,<span class="dt">size=</span>rows<span class="op">*</span>cols),</span>
<span id="cb643-16"><a href="solution.html#cb643-16"></a>              <span class="dt">nrow =</span> rows,</span>
<span id="cb643-17"><a href="solution.html#cb643-17"></a>              <span class="dt">ncol =</span> cols)</span></code></pre></div>
<p>We now have the matrix <code>mat</code> that contains letters from our word <strong>KAYAK</strong> in totally random order. The bigger the matrix gets via the <code>cols</code> and <code>rows</code> arguments the more likely is it that it contains the word itself up to a few times. Therefore, we have to check for that and correct this when necessary.</p>
<p>Logically there are a couple of approaches to solve the task of controlling if <code>mat</code> contains our word more often and of course it is possible to directly check for this while generating the matrix. Another option is to decompose the matrix by rows and columns and check if the resulting and/or the reversed string contains our word. A more loop-based solution is going through the letters one by one and check if starting with the actual position the word can be found either horizontally, horizontally reversed, vertically or vertically reversed. Every time the word is found, the corresponding part is replaced with new random letters drawn from the word. As we can not be sure that we have not accidentally created the word by replacing the letters in an earlier position we have to go once again through the matrix after finishing our first iteration so that we can be sure that the word is not included anymore. So our first step towards the solution is to create a complete word free matrix. Using loops this can be translated in two nested <code>for</code>-loops running through rows and columns of <code>mat</code> and a <code>while</code>-loop that encapsulates the nested loops and takes care of starting over when we have replaced the occurring word in the matrix. In this case, our skeleton looks like this:</p>
<div class="sourceCode" id="cb644"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb644-1"><a href="solution.html#cb644-1"></a>check &lt;-<span class="st"> </span><span class="ot">TRUE</span>    <span class="co"># Make sure the while loop is entered</span></span>
<span id="cb644-2"><a href="solution.html#cb644-2"></a></span>
<span id="cb644-3"><a href="solution.html#cb644-3"></a><span class="cf">while</span> ( check <span class="op">==</span><span class="st"> </span><span class="ot">TRUE</span> ){</span>
<span id="cb644-4"><a href="solution.html#cb644-4"></a>  </span>
<span id="cb644-5"><a href="solution.html#cb644-5"></a>  check &lt;-<span class="st"> </span><span class="ot">FALSE</span> <span class="co"># Assuming one iteration is enough we can leave the</span></span>
<span id="cb644-6"><a href="solution.html#cb644-6"></a>                 <span class="co"># loop after the current iteration. </span></span>
<span id="cb644-7"><a href="solution.html#cb644-7"></a>  </span>
<span id="cb644-8"><a href="solution.html#cb644-8"></a>  <span class="cf">for</span> ( row <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(mat)){    <span class="co"># Loop running through rows</span></span>
<span id="cb644-9"><a href="solution.html#cb644-9"></a>    <span class="cf">for</span> (col <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">ncol</span>(mat)){   <span class="co"># Loop running through columns</span></span>
<span id="cb644-10"><a href="solution.html#cb644-10"></a>      </span>
<span id="cb644-11"><a href="solution.html#cb644-11"></a>      <span class="co"># Code to solve the actual problem!</span></span>
<span id="cb644-12"><a href="solution.html#cb644-12"></a>      </span>
<span id="cb644-13"><a href="solution.html#cb644-13"></a>    } <span class="co"># End for (columns)</span></span>
<span id="cb644-14"><a href="solution.html#cb644-14"></a>  } <span class="co">#End for (rows)</span></span>
<span id="cb644-15"><a href="solution.html#cb644-15"></a>} <span class="co">#End while</span></span></code></pre></div>
<p>With that basic setup we run through the entire matrix one element at a time. We can easily adress the element using the running variables <code>row</code> and <code>col</code> from the <code>for</code>-loops using them as indices in brackets. Depending on the word length we can now calculate which submatrix of <code>mat</code> has to be checked for our word. Namely these areas are the following ones:</p>
<div class="sourceCode" id="cb645"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb645-1"><a href="solution.html#cb645-1"></a><span class="co"># Obtain ranges to check for the word</span></span>
<span id="cb645-2"><a href="solution.html#cb645-2"></a>mat[row,col<span class="op">:</span>(col<span class="op">+</span><span class="kw">length</span>(word)<span class="op">-</span><span class="dv">1</span>)] <span class="co"># Horizontal (left to right)</span></span>
<span id="cb645-3"><a href="solution.html#cb645-3"></a>mat[row,(col<span class="op">-</span><span class="kw">length</span>(word)<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>col] <span class="co"># Horizontal reverse (right to left)</span></span>
<span id="cb645-4"><a href="solution.html#cb645-4"></a>mat[row<span class="op">:</span>(row<span class="op">+</span><span class="kw">length</span>(word)<span class="op">-</span><span class="dv">1</span>),col] <span class="co"># Vertical (top to bottom)</span></span>
<span id="cb645-5"><a href="solution.html#cb645-5"></a>mat[(row<span class="op">-</span><span class="kw">length</span>(word)<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>row,col] <span class="co"># Vertical reverse (bottom to top)</span></span></code></pre></div>
<p>As it makes sense not to wrap everything in <code>if-else</code>-clauses we can simply put the indices which we have to check in lists and use them out of another loop to compare them with the actual word. Wrapping them in a list so that we can dynamically address them is easily done like so:</p>
<div class="sourceCode" id="cb646"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb646-1"><a href="solution.html#cb646-1"></a>rows &lt;-<span class="st"> </span><span class="kw">list</span>(row,                      <span class="co"># List for row indices</span></span>
<span id="cb646-2"><a href="solution.html#cb646-2"></a>             row,</span>
<span id="cb646-3"><a href="solution.html#cb646-3"></a>             row<span class="op">:</span>(row<span class="op">+</span><span class="kw">length</span>(word)<span class="op">-</span><span class="dv">1</span>),</span>
<span id="cb646-4"><a href="solution.html#cb646-4"></a>             (row<span class="op">-</span><span class="kw">length</span>(word)<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>row)</span>
<span id="cb646-5"><a href="solution.html#cb646-5"></a></span>
<span id="cb646-6"><a href="solution.html#cb646-6"></a></span>
<span id="cb646-7"><a href="solution.html#cb646-7"></a>cols &lt;-<span class="st"> </span><span class="kw">list</span>(col<span class="op">:</span>(col<span class="op">+</span><span class="kw">length</span>(word)<span class="op">-</span><span class="dv">1</span>), <span class="co"># List for column indices</span></span>
<span id="cb646-8"><a href="solution.html#cb646-8"></a>             (col<span class="op">-</span><span class="kw">length</span>(word)<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>col,</span>
<span id="cb646-9"><a href="solution.html#cb646-9"></a>             col,</span>
<span id="cb646-10"><a href="solution.html#cb646-10"></a>             col)</span></code></pre></div>
<p>Now we can loop through the list entries and perform our comparison and then act accordingly, which can easily be done by using an <code>if</code>-clause and checking if the submatrix we are looking at is identical with our word. Sadly this is not enough. As we dynamically calculate the indices for the submatrix when using our lists <code>rows</code> and <code>columns</code> we have not yet checked if the indices exist. For example, when looking at the top left element in the matrix (<code>mat[1,1]</code>) we can not check if the indices from bottom to top and from right to left correspond to our word, because these indices do not exist and are negative numbers in our list. In this case, R responds with an error:</p>
<div class="sourceCode" id="cb647"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb647-1"><a href="solution.html#cb647-1"></a>mat[<span class="dv">1</span>,(<span class="dv">1</span><span class="op">:-</span><span class="dv">5</span>)]</span></code></pre></div>
<pre><code>#R&gt; Error in mat[1, (1:-5)]: only 0&#39;s may be mixed with negative subscripts</code></pre>
<p>The same happens when we look at the bottom right element of the matrix and try to examine the cases horizontally and vertically as these do not exist. That means before overwriting an occurrence we have to check for 5 things.</p>
<ol style="list-style-type: decimal">
<li>Are all calculated row indices bigger than zero and really in the matrix?</li>
<li>Are all calculated column indices bigger than zero so that they can really be addressed?</li>
<li>Are all calculated row indices smaller than the maximum row-dimension of the matrix and therefore not out of <code>mat</code>s boundaries?</li>
<li>Are all calculated column indices smaller than the maximum column-dimension of the matrix so that they are really present in the matrix?</li>
<li>Does the submatrix equal the word we are looking for?</li>
</ol>
<p>Due to the properties of the <code>&amp;&amp;</code>-Operator, we can perform all these comparisons in one if clause including the check if the submatrix equals the word. Even though the indices in the matrix do not exist in the matrix (be sure to understand why this does not work with the single <code>AND</code> operator (<code>&amp;</code>) which leads to the following code including the overwriting with a fresh randomly selected set of letters from our word:</p>
<div class="sourceCode" id="cb649"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb649-1"><a href="solution.html#cb649-1"></a><span class="cf">for</span> ( idx <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(rows)){ <span class="co"># Could have used length(cols) instead</span></span>
<span id="cb649-2"><a href="solution.html#cb649-2"></a>  </span>
<span id="cb649-3"><a href="solution.html#cb649-3"></a>  <span class="co"># If all rows and cols are in matrix and not out of bound and</span></span>
<span id="cb649-4"><a href="solution.html#cb649-4"></a>  <span class="co"># the range equals the word resample this section of the matrix.</span></span>
<span id="cb649-5"><a href="solution.html#cb649-5"></a>  </span>
<span id="cb649-6"><a href="solution.html#cb649-6"></a>  <span class="cf">if</span> ( <span class="kw">all</span>(rows[[idx]] <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>) <span class="op">&amp;&amp;</span><span class="st">                           </span><span class="co"># Check 1</span></span>
<span id="cb649-7"><a href="solution.html#cb649-7"></a><span class="st">       </span><span class="kw">all</span>(cols[[idx]] <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>) <span class="op">&amp;&amp;</span><span class="st">                           </span><span class="co"># Check 2</span></span>
<span id="cb649-8"><a href="solution.html#cb649-8"></a><span class="st">       </span><span class="kw">all</span>(rows[[idx]] <span class="op">&lt;=</span><span class="st"> </span><span class="kw">nrow</span>(mat)) <span class="op">&amp;&amp;</span><span class="st">                  </span><span class="co"># Check 3</span></span>
<span id="cb649-9"><a href="solution.html#cb649-9"></a><span class="st">       </span><span class="kw">all</span>(cols[[idx]] <span class="op">&lt;=</span><span class="st"> </span><span class="kw">ncol</span>(mat)) <span class="op">&amp;&amp;</span><span class="st">                  </span><span class="co"># Check 4</span></span>
<span id="cb649-10"><a href="solution.html#cb649-10"></a><span class="st">       </span><span class="kw">identical</span>(mat[rows[[idx]], cols[[idx]]],word)) {  <span class="co"># Check 5</span></span>
<span id="cb649-11"><a href="solution.html#cb649-11"></a>    </span>
<span id="cb649-12"><a href="solution.html#cb649-12"></a>    <span class="co"># Overwrite the submatrix with fresh sampled letters</span></span>
<span id="cb649-13"><a href="solution.html#cb649-13"></a>    mat[rows[[idx]],cols[[idx]]] &lt;-<span class="st"> </span><span class="kw">sample</span>(word,</span>
<span id="cb649-14"><a href="solution.html#cb649-14"></a>                                       <span class="dt">replace=</span>T,</span>
<span id="cb649-15"><a href="solution.html#cb649-15"></a>                                       <span class="dt">size=</span><span class="kw">length</span>(word))</span>
<span id="cb649-16"><a href="solution.html#cb649-16"></a>    </span>
<span id="cb649-17"><a href="solution.html#cb649-17"></a>    <span class="co"># After replacing we have to check the whole matrix again,</span></span>
<span id="cb649-18"><a href="solution.html#cb649-18"></a>    <span class="co"># there we make sure to reenter the while loop!</span></span>
<span id="cb649-19"><a href="solution.html#cb649-19"></a>    check &lt;-<span class="st"> </span><span class="ot">TRUE</span></span>
<span id="cb649-20"><a href="solution.html#cb649-20"></a>    </span>
<span id="cb649-21"><a href="solution.html#cb649-21"></a>    <span class="co"># Feature to count how many occurrences have been replaced</span></span>
<span id="cb649-22"><a href="solution.html#cb649-22"></a>    wordcounter &lt;-<span class="st"> </span>wordcounter <span class="op">+</span><span class="st"> </span><span class="dv">1</span></span>
<span id="cb649-23"><a href="solution.html#cb649-23"></a>    </span>
<span id="cb649-24"><a href="solution.html#cb649-24"></a>  } <span class="co">#End if</span></span>
<span id="cb649-25"><a href="solution.html#cb649-25"></a>} <span class="co">#End for</span></span></code></pre></div>
<p>When the <code>while</code>-loop has terminated we are left with a clean matrix that surely does not contain our word in the checked dimensions. If you want to be really evil you can printout the puzzle, give it to some friends and let them search for the word. If you only want to create a hard puzzle you can choose a random location to overwrite the letters there with the word.</p>
<p>All thats left to do is wrapping the existing code in a function with the requested name <code>evilpuzzle()</code>. If you want to improve the routine a little bit and make it more flexible you can implement some switches using <code>if-else</code>-clauses to control if the puzzle should be evil or super evil, meaning containing the search word or not and after placing the word within <code>mat</code> crosscheck if that only leads to a single occurrence and cannot be assembled into multiple hits when trying to solve the puzzle. If that is not enough you can also implement checking for diagonal occurrences of the word. The function corresponding to the exercise after assembling the discussed bits may look like this:</p>
<div class="sourceCode" id="cb650"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb650-1"><a href="solution.html#cb650-1"></a>evilpuzzle &lt;-<span class="st"> </span><span class="cf">function</span>(<span class="dt">word =</span> <span class="kw">c</span>(<span class="st">&quot;T&quot;</span>,<span class="st">&quot;E&quot;</span>,<span class="st">&quot;S&quot;</span>,<span class="st">&quot;T&quot;</span>),</span>
<span id="cb650-2"><a href="solution.html#cb650-2"></a>                       <span class="dt">cols =</span> <span class="dv">15</span>,</span>
<span id="cb650-3"><a href="solution.html#cb650-3"></a>                       <span class="dt">rows =</span> <span class="dv">10</span>,</span>
<span id="cb650-4"><a href="solution.html#cb650-4"></a>                       <span class="dt">inclword=</span><span class="ot">TRUE</span>) {</span>
<span id="cb650-5"><a href="solution.html#cb650-5"></a></span>
<span id="cb650-6"><a href="solution.html#cb650-6"></a><span class="co"># Check if provided word is longer than 3 characters</span></span>
<span id="cb650-7"><a href="solution.html#cb650-7"></a><span class="cf">if</span> ( <span class="kw">sum</span>(<span class="kw">nchar</span>(word)) <span class="op">&lt;</span><span class="st"> </span><span class="dv">3</span> ) {</span>
<span id="cb650-8"><a href="solution.html#cb650-8"></a>  <span class="kw">stop</span>(<span class="st">&quot;The provided word has to be longer than 3 characters!&quot;</span>)</span>
<span id="cb650-9"><a href="solution.html#cb650-9"></a>}</span>
<span id="cb650-10"><a href="solution.html#cb650-10"></a></span>
<span id="cb650-11"><a href="solution.html#cb650-11"></a><span class="co"># Initialize</span></span>
<span id="cb650-12"><a href="solution.html#cb650-12"></a>wordcounter &lt;-<span class="st"> </span><span class="dv">0</span></span>
<span id="cb650-13"><a href="solution.html#cb650-13"></a></span>
<span id="cb650-14"><a href="solution.html#cb650-14"></a><span class="co"># Generate word matrix vectorized</span></span>
<span id="cb650-15"><a href="solution.html#cb650-15"></a>mat &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">sample</span>(word,<span class="dt">replace=</span>T,<span class="dt">size=</span>rows<span class="op">*</span>cols),</span>
<span id="cb650-16"><a href="solution.html#cb650-16"></a>              <span class="dt">nrow =</span> rows,</span>
<span id="cb650-17"><a href="solution.html#cb650-17"></a>              <span class="dt">ncol =</span> cols)</span>
<span id="cb650-18"><a href="solution.html#cb650-18"></a></span>
<span id="cb650-19"><a href="solution.html#cb650-19"></a>check &lt;-<span class="st"> </span><span class="ot">TRUE</span>    <span class="co"># Make sure the while loop is entered</span></span>
<span id="cb650-20"><a href="solution.html#cb650-20"></a></span>
<span id="cb650-21"><a href="solution.html#cb650-21"></a><span class="cf">while</span> ( check <span class="op">==</span><span class="st"> </span><span class="ot">TRUE</span> ){</span>
<span id="cb650-22"><a href="solution.html#cb650-22"></a>  </span>
<span id="cb650-23"><a href="solution.html#cb650-23"></a>  check &lt;-<span class="st"> </span><span class="ot">FALSE</span> <span class="co"># Assuming one iteration is enough we can leave the</span></span>
<span id="cb650-24"><a href="solution.html#cb650-24"></a>                 <span class="co"># loop after the current iteration. </span></span>
<span id="cb650-25"><a href="solution.html#cb650-25"></a>  </span>
<span id="cb650-26"><a href="solution.html#cb650-26"></a>  <span class="cf">for</span> ( row <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(mat)){    <span class="co"># Loop running through rows</span></span>
<span id="cb650-27"><a href="solution.html#cb650-27"></a>    <span class="cf">for</span> (col <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">ncol</span>(mat)){   <span class="co"># Loop running through columns</span></span>
<span id="cb650-28"><a href="solution.html#cb650-28"></a>      </span>
<span id="cb650-29"><a href="solution.html#cb650-29"></a>      rows &lt;-<span class="st"> </span><span class="kw">list</span>(row,                      <span class="co"># List for row indices</span></span>
<span id="cb650-30"><a href="solution.html#cb650-30"></a>                   row,</span>
<span id="cb650-31"><a href="solution.html#cb650-31"></a>                   row<span class="op">:</span>(row<span class="op">+</span><span class="kw">length</span>(word)<span class="op">-</span><span class="dv">1</span>),</span>
<span id="cb650-32"><a href="solution.html#cb650-32"></a>                   (row<span class="op">-</span><span class="kw">length</span>(word)<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>row)</span>
<span id="cb650-33"><a href="solution.html#cb650-33"></a>      </span>
<span id="cb650-34"><a href="solution.html#cb650-34"></a>      </span>
<span id="cb650-35"><a href="solution.html#cb650-35"></a>      cols &lt;-<span class="st"> </span><span class="kw">list</span>(col<span class="op">:</span>(col<span class="op">+</span><span class="kw">length</span>(word)<span class="op">-</span><span class="dv">1</span>), <span class="co"># List for column indices</span></span>
<span id="cb650-36"><a href="solution.html#cb650-36"></a>                   (col<span class="op">-</span><span class="kw">length</span>(word)<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>col,</span>
<span id="cb650-37"><a href="solution.html#cb650-37"></a>                   col,</span>
<span id="cb650-38"><a href="solution.html#cb650-38"></a>                   col)</span>
<span id="cb650-39"><a href="solution.html#cb650-39"></a>      </span>
<span id="cb650-40"><a href="solution.html#cb650-40"></a><span class="co"># &lt;-- Indent removed for better overview outside of IDE!</span></span>
<span id="cb650-41"><a href="solution.html#cb650-41"></a>            </span>
<span id="cb650-42"><a href="solution.html#cb650-42"></a><span class="cf">for</span> ( idx <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(rows)){ <span class="co"># Could have used length(cols) instead</span></span>
<span id="cb650-43"><a href="solution.html#cb650-43"></a>  </span>
<span id="cb650-44"><a href="solution.html#cb650-44"></a>  </span>
<span id="cb650-45"><a href="solution.html#cb650-45"></a>  <span class="co"># If all rows and cols are in matrix and not out of bound and</span></span>
<span id="cb650-46"><a href="solution.html#cb650-46"></a>  <span class="co"># the range equals the word resample this section of the matrix.</span></span>
<span id="cb650-47"><a href="solution.html#cb650-47"></a>  </span>
<span id="cb650-48"><a href="solution.html#cb650-48"></a>  <span class="cf">if</span> ( <span class="kw">all</span>(rows[[idx]] <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>) <span class="op">&amp;&amp;</span><span class="st">                           </span><span class="co"># Check 1</span></span>
<span id="cb650-49"><a href="solution.html#cb650-49"></a><span class="st">       </span><span class="kw">all</span>(cols[[idx]] <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>) <span class="op">&amp;&amp;</span><span class="st">                           </span><span class="co"># Check 2</span></span>
<span id="cb650-50"><a href="solution.html#cb650-50"></a><span class="st">       </span><span class="kw">all</span>(rows[[idx]] <span class="op">&lt;=</span><span class="st"> </span><span class="kw">nrow</span>(mat)) <span class="op">&amp;&amp;</span><span class="st">                  </span><span class="co"># Check 3</span></span>
<span id="cb650-51"><a href="solution.html#cb650-51"></a><span class="st">       </span><span class="kw">all</span>(cols[[idx]] <span class="op">&lt;=</span><span class="st"> </span><span class="kw">ncol</span>(mat)) <span class="op">&amp;&amp;</span><span class="st">                  </span><span class="co"># Check 4</span></span>
<span id="cb650-52"><a href="solution.html#cb650-52"></a><span class="st">       </span><span class="kw">identical</span>(mat[rows[[idx]],cols[[idx]]],word)) {   <span class="co"># Check 5</span></span>
<span id="cb650-53"><a href="solution.html#cb650-53"></a>    </span>
<span id="cb650-54"><a href="solution.html#cb650-54"></a>    <span class="co"># Overwrite the submatrix with fresh sampled letters</span></span>
<span id="cb650-55"><a href="solution.html#cb650-55"></a>    mat[rows[[idx]],cols[[idx]]] &lt;-<span class="st"> </span><span class="kw">sample</span>(word,</span>
<span id="cb650-56"><a href="solution.html#cb650-56"></a>                                       <span class="dt">replace=</span>T,</span>
<span id="cb650-57"><a href="solution.html#cb650-57"></a>                                       <span class="dt">size=</span><span class="kw">length</span>(word))</span>
<span id="cb650-58"><a href="solution.html#cb650-58"></a>    </span>
<span id="cb650-59"><a href="solution.html#cb650-59"></a>    <span class="co"># After replacing we have to check the whole matrix again,</span></span>
<span id="cb650-60"><a href="solution.html#cb650-60"></a>    <span class="co"># therefore we make sure to reenter the while loop!</span></span>
<span id="cb650-61"><a href="solution.html#cb650-61"></a>    check &lt;-<span class="st"> </span><span class="ot">TRUE</span></span>
<span id="cb650-62"><a href="solution.html#cb650-62"></a>    </span>
<span id="cb650-63"><a href="solution.html#cb650-63"></a>    <span class="co"># Feature to count how many occurrences have been replaced</span></span>
<span id="cb650-64"><a href="solution.html#cb650-64"></a>    wordcounter &lt;-<span class="st"> </span>wordcounter <span class="op">+</span><span class="st"> </span><span class="dv">1</span></span>
<span id="cb650-65"><a href="solution.html#cb650-65"></a>    </span>
<span id="cb650-66"><a href="solution.html#cb650-66"></a>  } <span class="co">#End if</span></span>
<span id="cb650-67"><a href="solution.html#cb650-67"></a>} <span class="co">#End for</span></span>
<span id="cb650-68"><a href="solution.html#cb650-68"></a></span>
<span id="cb650-69"><a href="solution.html#cb650-69"></a><span class="co"># &lt;-- Indent removed for better overview outside of IDE!    </span></span>
<span id="cb650-70"><a href="solution.html#cb650-70"></a></span>
<span id="cb650-71"><a href="solution.html#cb650-71"></a>    } <span class="co"># End for (columns)</span></span>
<span id="cb650-72"><a href="solution.html#cb650-72"></a>  } <span class="co">#End for (rows)</span></span>
<span id="cb650-73"><a href="solution.html#cb650-73"></a>} <span class="co">#End while</span></span>
<span id="cb650-74"><a href="solution.html#cb650-74"></a></span>
<span id="cb650-75"><a href="solution.html#cb650-75"></a><span class="co"># Message to the user how often the word has been replaced</span></span>
<span id="cb650-76"><a href="solution.html#cb650-76"></a><span class="kw">cat</span>(<span class="st">&quot;The word&quot;</span>, <span class="kw">paste</span>(word,<span class="dt">sep=</span><span class="st">&quot;&quot;</span>, <span class="dt">collapse=</span><span class="st">&quot;&quot;</span>), </span>
<span id="cb650-77"><a href="solution.html#cb650-77"></a>    <span class="st">&quot;was replaced&quot;</span>, wordcounter, <span class="st">&quot;times! </span><span class="ch">\n</span><span class="st">&quot;</span> )</span>
<span id="cb650-78"><a href="solution.html#cb650-78"></a></span>
<span id="cb650-79"><a href="solution.html#cb650-79"></a><span class="co"># Add word to clean matrix if desired (only horizontally)</span></span>
<span id="cb650-80"><a href="solution.html#cb650-80"></a><span class="cf">if</span> ( inclword <span class="op">==</span><span class="st"> </span><span class="ot">TRUE</span>) {</span>
<span id="cb650-81"><a href="solution.html#cb650-81"></a>  row &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(mat),<span class="dt">size=</span><span class="dv">1</span>)</span>
<span id="cb650-82"><a href="solution.html#cb650-82"></a>  col &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span>(<span class="kw">ncol</span>(mat)<span class="op">-</span><span class="kw">length</span>(word)),<span class="dt">size=</span><span class="dv">1</span>)</span>
<span id="cb650-83"><a href="solution.html#cb650-83"></a>  mat[row,col<span class="op">:</span>(col<span class="op">+</span><span class="kw">length</span>(word)<span class="op">-</span><span class="dv">1</span>)] &lt;-<span class="st"> </span>word</span>
<span id="cb650-84"><a href="solution.html#cb650-84"></a>}</span>
<span id="cb650-85"><a href="solution.html#cb650-85"></a></span>
<span id="cb650-86"><a href="solution.html#cb650-86"></a><span class="co"># Return the finished matrix to the user</span></span>
<span id="cb650-87"><a href="solution.html#cb650-87"></a><span class="kw">return</span>(mat)</span>
<span id="cb650-88"><a href="solution.html#cb650-88"></a></span>
<span id="cb650-89"><a href="solution.html#cb650-89"></a>} <span class="co">#End function</span></span></code></pre></div>
<p>The function <code>evilpuzzle()</code> now suits the desired needs and is a promising candidate to fulfill the needs described in the exercise. However, there is much room for improvement as the program only supports inserting the word horizontally and as it does not support inserting it differently the user is not able to select in which way it should be represented in the matrix. As stated before the chosen approach is not very efficient as the word is compared with the submatrix for all four orientations and for every element in the matrix. Further following improvements are left to the user:</p>
<ul>
<li>The performed comparison of the submatrices with the word is not necessary for every element of the matrix. If the element we are looking at in a certain iteration does not equal the first letter of <code>word</code> there is no need to compare the whole submatrices. Therefore we can implement such a simple test to improve the efficiency of our program.</li>
<li>One major flaw of the program is that the word (if inserted in the matrix), is only inserted horizontally. The optimal solution would allow the user to select between inserting it at a random or desired orientation either horizontally, horizontally reversed, vertically or vertically reversed. A bonus would be to make the selection of the orientation of the words also random to allow a user to generate a puzzle for themselves.</li>
<li>Right now the program only supports searching vertically or horizontally word occurrences and ignores the option of diagonal combinations. Therefore more checks can be implemented to make the puzzle even harder. The four diagonal cases should also be considered in the options for inserting the word in the matrix.</li>
<li>Inserting the word in the matrix can lead to multiple possible combinations. Therefore a control mode should be programmed that counts the occurrences in the matrix and corrects multiple occurrences in a suitable way so that the word can only be found once in the final puzzle.</li>
<li>There are many other and much more efficient ways to solve this exercise - we just have thrown together what we learned so far. If you can not get enough you can try generating the word puzzle in a totally different way, the string section can solve as source as inspiration.</li>
</ul>
<p>After this little exercise, you should have a good feeling of how loops and conditional expression can be used to actually do something (more or less) productive and you should have beaten the concepts we just discussed.</p>

</div>
<!-- </div> -->
            </section>

          </div>
        </div>
      </div>
<a href="requirements.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="blockchain.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/08-appliedprogramming.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["bchwtz-cswr.pdf", "bchwtz-cswr.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
